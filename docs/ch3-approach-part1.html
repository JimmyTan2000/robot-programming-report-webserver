
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Approaches to Challenges (Part 1) &#8212; Robot_Programming_Report  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="static/styles/sphinx-book-theme.css?v=a3416100" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="static/documentation_options.js?v=9eb32ce0"></script>
    <script src="static/doctools.js?v=9a2dae69"></script>
    <script src="static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ch3-approach-part1';</script>
    <link rel="icon" href="static/apple_notes_icon_public_domain_via_wikimedia_commons.svg"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Approaches to Challenges (Part 2)" href="ch3-approach-part2.html" />
    <link rel="prev" title="Relevant concepts" href="ch2-relevant-concepts.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="static/apple_notes_icon_public_domain_via_wikimedia_commons.svg" class="logo__image only-light" alt="Robot_Programming_Report  documentation - Home"/>
    <script>document.write(`<img src="static/apple_notes_icon_public_domain_via_wikimedia_commons.svg" class="logo__image only-dark" alt="Robot_Programming_Report  documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ch1-problem.html">The problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="ch2-relevant-concepts.html">Relevant concepts</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Approaches to Challenges (Part 1)</a></li>




<li class="toctree-l1"><a class="reference internal" href="ch3-approach-part2.html">Approaches to Challenges (Part 2)</a></li>

<li class="toctree-l1"><a class="reference internal" href="ch4-results.html">Conclusion and Takeaways</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="sources/ch3-approach-part1.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Approaches to Challenges (Part 1)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Approaches to Challenges (Part 1)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#challenge-1">Challenge 1</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-for-challenge-1">Solution for Challenge 1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-the-minimum-value-of-the-laser-distance-sensor-lds-that-we-should-stop"><em>What is the minimum value of the laser distance sensor (LDS) that we should stop?</em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-can-we-set-the-speed-of-the-bot"><em>How can we set the speed of the bot?</em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#result"><em>Result</em>:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#challenge-2">Challenge 2</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-for-challenge-2">Solution for challenge 2</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><em>Result</em>:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#challenge-3">Challenge 3</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-for-challenge-3">Solution for challenge 3</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><em>Result</em>:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#challenge-4">Challenge 4</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach-1"><em>Approach 1</em>:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach-2"><em>Approach 2</em>:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><em>Result</em>:</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="approaches-to-challenges-part-1">
<h1>Approaches to Challenges (Part 1)<a class="headerlink" href="#approaches-to-challenges-part-1" title="Link to this heading">#</a></h1>
<p>The approaches and solutions for Challenge 1 to Challenge 4 are written and explained in this slide. For Challenge 5, please read part 2.</p>
</section>
<hr class="docutils" />
<section id="challenge-1">
<h1>Challenge 1<a class="headerlink" href="#challenge-1" title="Link to this heading">#</a></h1>
<p>This is the first challenge to get our hands warm for the course. The goal of this challenge is to drive to the red wall as close as we can and stop without colliding into it. For this challenge, we need to run the bot in a simulated world of 1 x 1 as shown in the screenshot below:</p>
<p><img alt="This is a pic for 1 x 1 world" src="images/world_1_1.png" /></p>
<p>In order to solve this challenge, there are two questions that has to be solved.</p>
<ol class="arabic simple">
<li><p>What is the minimum value of the laser distance sensor (LDS) that we should stop?</p></li>
<li><p>How can we set the speed of the bot?</p></li>
</ol>
<section id="solution-for-challenge-1">
<h2>Solution for Challenge 1<a class="headerlink" href="#solution-for-challenge-1" title="Link to this heading">#</a></h2>
<p>In challenge 1 (as well as other following challenges), I am using tb3.py from Professor Gökçe Aydos as a starting point. In his code, there is a class for Tb3 node, and inside this node there is a publisher and a subscriber. The publisher will publish to the ‘cmd_vel’ topic and the subscriber will get the data from the Laser Scanner. The original code for the class are shown below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="k">class</span> <span class="nc">Tb3</span><span class="p">(</span><span class="n">Node</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s1">&#39;tb3&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">cmd_vel_pub</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_publisher</span><span class="p">(</span>
                    <span class="n">Twist</span><span class="p">,</span>      <span class="c1"># message type</span>
                    <span class="s1">&#39;cmd_vel&#39;</span><span class="p">,</span>  <span class="c1"># topic name</span>
                    <span class="mi">1</span><span class="p">)</span>          <span class="c1"># history depth</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">scan_sub</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_subscription</span><span class="p">(</span>
                    <span class="n">LaserScan</span><span class="p">,</span>
                    <span class="s1">&#39;scan&#39;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">scan_callback</span><span class="p">,</span>  <span class="c1"># function to run upon message arrival</span>
                    <span class="n">qos_profile_sensor_data</span><span class="p">)</span>  <span class="c1"># allows packet loss</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ang_vel_percent</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lin_vel_percent</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">def</span> <span class="nf">vel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lin_vel_percent</span><span class="p">,</span> <span class="n">ang_vel_percent</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot; publishes linear and angular velocities in percent</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># for TB3 Waffle</span>
            <span class="n">MAX_LIN_VEL</span> <span class="o">=</span> <span class="mf">0.26</span>  <span class="c1"># m/s</span>
            <span class="n">MAX_ANG_VEL</span> <span class="o">=</span> <span class="mf">1.82</span>  <span class="c1"># rad/s</span>

            <span class="n">cmd_vel_msg</span> <span class="o">=</span> <span class="n">Twist</span><span class="p">()</span>
            <span class="n">cmd_vel_msg</span><span class="o">.</span><span class="n">linear</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">MAX_LIN_VEL</span> <span class="o">*</span> <span class="n">lin_vel_percent</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="n">cmd_vel_msg</span><span class="o">.</span><span class="n">angular</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">MAX_ANG_VEL</span> <span class="o">*</span> <span class="n">ang_vel_percent</span> <span class="o">/</span> <span class="mi">100</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">cmd_vel_pub</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span><span class="n">cmd_vel_msg</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ang_vel_percent</span> <span class="o">=</span> <span class="n">ang_vel_percent</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lin_vel_percent</span> <span class="o">=</span> <span class="n">lin_vel_percent</span>

        <span class="k">def</span> <span class="nf">scan_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot; is run whenever a LaserScan msg is received</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="nb">print</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distances:&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;⬆️ :&#39;</span><span class="p">,</span> <span class="n">msg</span><span class="o">.</span><span class="n">ranges</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;⬇️ :&#39;</span><span class="p">,</span> <span class="n">msg</span><span class="o">.</span><span class="n">ranges</span><span class="p">[</span><span class="mi">180</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;⬅️ :&#39;</span><span class="p">,</span> <span class="n">msg</span><span class="o">.</span><span class="n">ranges</span><span class="p">[</span><span class="mi">90</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;➡️ :&#39;</span><span class="p">,</span> <span class="n">msg</span><span class="o">.</span><span class="n">ranges</span><span class="p">[</span><span class="o">-</span><span class="mi">90</span><span class="p">])</span>
</pre></div>
</div>
<p>As we can see from the code above, the function “scan_callback()” is making use of the subscriber to get the data from the simulated Laser Scanner of the robot. When the Tb3 node is active, the scan_callback() function will be run constantly and the laser data will be collected at the rate of 5 hertz. How do I know that?</p>
<p>While the node is active, we can see all active topics by running the following command in the shell:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ros2 topic list -t 
</pre></div>
</div>
<p>The flag “-t” enables us to see the type of every topic.
After running the above command, it returns the following:</p>
<p><img alt="Pic for topics" src="images/topic_list.png" /></p>
<p>The topic responsible for the laser scan is “/scan”, as you can see from the type written behind in the square bracket. You can check its frequecy by the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ros2 topic hz /scan
</pre></div>
</div>
<p>And it returns the following:</p>
<p><img alt="Frequency for topic /scan" src="images/scan_frequency.png" /></p>
<section id="what-is-the-minimum-value-of-the-laser-distance-sensor-lds-that-we-should-stop">
<h3><em>What is the minimum value of the laser distance sensor (LDS) that we should stop?</em><a class="headerlink" href="#what-is-the-minimum-value-of-the-laser-distance-sensor-lds-that-we-should-stop" title="Link to this heading">#</a></h3>
<p>Ideally, we should stop very near to the wall without crashing into it. Theoretically speaking, the closer the distance is to 0, the better. But sadly, there are simply too much noises in the Laser Scan (simulated LiDAR) sensor, so we cannot set the distance too close to the wall as well. The sweet spot I found via trial and error is about 0.18.</p>
</section>
<section id="how-can-we-set-the-speed-of-the-bot">
<h3><em>How can we set the speed of the bot?</em><a class="headerlink" href="#how-can-we-set-the-speed-of-the-bot" title="Link to this heading">#</a></h3>
<p>The percentage of angular and linear velocity, defined by “self.ang_vel_percent” and “self.lin_vel_percent” respectively, are set to 0 by default. We can use the setter function “vel()” to change both of the values. The vel() function takes two extra parameters, namely “lin_vel_percent” that is used to change the linear velocity, and “ang_vel_percent” that is used to change the angular velocity of the robot. The angular velocity, however, will be set to 0 by default if the value is not given to the function.
Therefore, we can make the robot move forward with for example 15% of its max linear velocity by writing the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="bp">self</span><span class="o">.</span><span class="n">vel</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
<p>Combining both concepts, the solution looks as simple as below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>     <span class="k">def</span> <span class="nf">scan_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; is run whenever a LaserScan msg is received</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">msg</span><span class="o">.</span><span class="n">ranges</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.18</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vel</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vel</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>This function will be executed everytime a LaserScan msg is received, about 5 times per second. The value msg.ranges[0] is the distance between the direct front of the robot to the obstacle (normally walls in our labyrinth). If the distance between them is more than 0.18, the robot will simply move forward with 15% of its maximum linear velocity, otherwise, it will stop completely.</p>
</section>
<section id="result">
<h3><em>Result</em>:<a class="headerlink" href="#result" title="Link to this heading">#</a></h3>
<p><img alt="Challenge 1 gif" src="images/challenge1_showcase.gif" /></p>
</section>
</section>
</section>
<hr class="docutils" />
<section id="challenge-2">
<h1>Challenge 2<a class="headerlink" href="#challenge-2" title="Link to this heading">#</a></h1>
<p>For this challenge, we are still working with the same 1 x 1 world as challenge 1. The task is to drive to the red wall and stop at a safe distance. After that, rotate counter clockwise and drive close to the wooden wall and stop. We are allowed to only use laser distance sensor data for this challenge.</p>
<section id="solution-for-challenge-2">
<h2>Solution for challenge 2<a class="headerlink" href="#solution-for-challenge-2" title="Link to this heading">#</a></h2>
<p>A simple state machine is implemented. However, the way of how it is implemented is not particularly elegant. I can show you some screenshots as examples for this “quick and dirty” approach.</p>
<p><img alt="State machines as string, example 1" src="images/challenge2_state_machines_1.png" /></p>
<p>As you can see from the screenshot above, there is one global variable named <mark>state</mark> with the value assigned to the string <mark>”go”</mark>. Its initial value will be overwritten by other functions as shown in the screenshot below:</p>
<p><img alt="State machines as string, overwriting mechanism" src="images/challenge2_state_overwriting.png" /></p>
<p>As you can see from the code above, this function will be using the global variable “state”, which is defined as “go” initially. Therefore it will run the function <mark>collision_avoidance_sensor()</mark> (will be explained later), with <mark>”stopped”</mark> as its next state. In other words, it will drive to the red wall and stop at a safe distance and switch to the next state “stopped”.</p>
<p>As the state transitioned to “stopped”, the robot will begin to turn counter-clockwise. Its right side will be the nearest to the red wall when it performs a near 90 degree turn. Therefore, the robot will stop its rotation when the right side is the nearest to the red wall. Via trial and error, I have determined that the value of the minimum distance appears to be 0.24.</p>
<p>The <mark>collision_avoidance_sensor()</mark> is just to allow the robot to move forward when there is no obstacle in front and stops when it gets too near to them. The code is shown below:</p>
<p><img alt="Collision avoidance with sensor, code" src="images/collision_avoidance_sensor.png" /></p>
<p>As you have probably already realised, the states that I am using here are not generic. For example, there are states such as “first rotation stopped” and “first wall reached”. The reason for that is, at the point of development, I have no idea that we have to make the code as general as possible so that it can solve different mazes with the same piece of code. So, for challenge 1 to challenge 4, the mazes are solved in such a hard coded way (which means the code would not work anymore if the maze changes). Fortunately, I have generalized the code in challenge 5.</p>
<section id="id1">
<h3><em>Result</em>:<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p><img alt="GIF for challenge 2" src="images/challenge2_showcase.gif" /></p>
</section>
</section>
</section>
<hr class="docutils" />
<section id="challenge-3">
<h1>Challenge 3<a class="headerlink" href="#challenge-3" title="Link to this heading">#</a></h1>
<p>This challenge is the exact same as challenge 2, but instead of using laser distance sensor, we are supposed to use the position and orientation published in <mark>/odom</mark></p>
<section id="solution-for-challenge-3">
<h2>Solution for challenge 3<a class="headerlink" href="#solution-for-challenge-3" title="Link to this heading">#</a></h2>
<p>Just like challenge 2, State Machines are also implemented here. However, it is implemented in a much elegant and cleaner way (although not perfect). Python Enumerations are used instead of using just strings. In this way, all the possible states can be written in just a single class. The enumeration class with the name “State” looks like this:</p>
<p><img alt="Screenshot for python enum" src="images/python_enum.png" /></p>
<p>As you can see from the screenshot above, all the states can be seen in just a glance. There are four states here, namely “GO”, “STOPPED”, “FIRST_ROTATION_STOPPED” and “END”. Since their names are pretty self-explanatory, I will not explain them here.</p>
<p>The Tb3 class will now have one extra instance attribute “self.state” with the initial value “State.GO”</p>
<p><img alt="Picture of self.state" src="images/self.state.png" /></p>
<p>And the states will also be changed at the end of other function calls like this:</p>
<p><img alt="State change enum" src="images/state_change_enum.png" /></p>
<p>In order to receive data from the <mark>/odom</mark> topic, I have created a subcription that receives the msg of type <mark>Odometry</mark>. The code looks very similar to the code for the subscription of the LaserScan:</p>
<p><img alt="Odom subscription" src="images/odom_sub.png" /></p>
<p>Getting odometry information from this subscription is also very similar to the scan_callback() function for the LaserScan. I have defined the name of the function as <mark>odom_callback</mark> and it looks like this:</p>
<p><img alt="Odom Callback" src="images/odom_callback.png" /></p>
<p>Among all the information returned by this odom_callback() function, the only one that is relevant for us is the orientation in free space represented in quaternion form. We can change them into euler angles in radian and change those angles from radian to degree just by multiplying it with the ratio of (180/pi). You can also use the built in python function math.degrees() to change it to degrees too.</p>
<p>From the quartenion information that is returned by the odom_callback(), we can obtain 3 euler angles in radian after conversion using the <mark>quat2euler()</mark> function from the transforms3d.euler library. I have named those angles as i, j and k. However, the only angle that will change during the rotation of the robot is <mark>k</mark>. <mark>k</mark> will have the value of 90 degrees when it is facing directly to the front, 0 degree when it is facing the right, -90 degrees when facing the back and -180 degrees when facing the left. Those information are summarized in the diagram below:</p>
<p><img alt="Odom compass" src="images/odom_compass.png" /></p>
<p>From the code above, we can see that the bot will stop rotating when the value of “k” is 180 or -180. Which also means that it will stop rotating when it is facing the left side, which is what we want to achieve in this challenge. It is obviously hard coded at this point. Code generalisation will be achieved in challenge 5.</p>
<section id="id2">
<h3><em>Result</em>:<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p><img alt="Result of challenge 3" src="images/challenge3_showcase.gif" /></p>
</section>
</section>
</section>
<hr class="docutils" />
<section id="challenge-4">
<h1>Challenge 4<a class="headerlink" href="#challenge-4" title="Link to this heading">#</a></h1>
<p>Different to other 3 challenges, now we are dealing with a 2 x 2 world instead of 1 x 1.
Shown below is the 2 x 2 world that we’re working with:</p>
<p><img alt="2 x 2 world picture" src="images/world_2_2.png" /></p>
<p>The task is to drive to the red wall and stop without any collision.</p>
<p>Now we have to find a way to differentiate between red, white and wooden walls. How do we do that?</p>
<section id="approach-1">
<h2><em>Approach 1</em>:<a class="headerlink" href="#approach-1" title="Link to this heading">#</a></h2>
<p>The first thing that came into my mind is to create another subscription to get data from the camera and differentiate them using their RGB values. However, this is not a very reliable approach. If the robot is very far away but facing the red wall, the robot may see half of the white space and half of the red wall. So purely based on RGB values quickly became a complicated approach.</p>
</section>
<section id="approach-2">
<h2><em>Approach 2</em>:<a class="headerlink" href="#approach-2" title="Link to this heading">#</a></h2>
<p>After investigating deeper into the output of the <mark>/scan</mark> topic, I realised that there is an <mark>intensities</mark> metadata. And even better, the intensity for different walls are unique. For example, red wall has the intensity of “2.0”, white wall has the intensity of “3.0”, and wooden wall has the value of “1.0”. This approach is used in the end to determine the type/ colour of the wall.</p>
<p>The screenshot below shows the <mark>intensities</mark> metadata for red walls:</p>
<p><img alt="Red wall LaserScan intensity" src="images/red_intensity.png" /></p>
<p>And again, for this challenge, there are more states as shown in the screenshot below, and yes, they are still hard coded in some way (Do this when it reaches the first cell, rotate, do that when the first rotation is stopped and so on until it reaches its end goal)</p>
<p><img alt="States for challenge 4" src="images/states_ch4.png" /></p>
<p>Surprisingly enough, because the solution is so hard coded, I can solve this maze without implementing a way to identify the red wall. I just make it stop after it has went through all the pre-defined states. It is, however, implemented in challenge 5 in order to make the code generalization possible.</p>
</section>
<section id="id3">
<h2><em>Result</em>:<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<p><img alt="Challenge 4 showcase" src="images/challenge4_showcase.gif" /></p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="ch2-relevant-concepts.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Relevant concepts</p>
      </div>
    </a>
    <a class="right-next"
       href="ch3-approach-part2.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Approaches to Challenges (Part 2)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Approaches to Challenges (Part 1)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#challenge-1">Challenge 1</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-for-challenge-1">Solution for Challenge 1</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-the-minimum-value-of-the-laser-distance-sensor-lds-that-we-should-stop"><em>What is the minimum value of the laser distance sensor (LDS) that we should stop?</em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-can-we-set-the-speed-of-the-bot"><em>How can we set the speed of the bot?</em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#result"><em>Result</em>:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#challenge-2">Challenge 2</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-for-challenge-2">Solution for challenge 2</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><em>Result</em>:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#challenge-3">Challenge 3</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-for-challenge-3">Solution for challenge 3</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><em>Result</em>:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#challenge-4">Challenge 4</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach-1"><em>Approach 1</em>:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach-2"><em>Approach 2</em>:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><em>Result</em>:</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jimmy Tan
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright Creative Commons Attribution 4.0 International License.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>